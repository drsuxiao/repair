{% extends 'base_repairs.html' %}
{% block title %}设备归还管理{% endblock %}
{% block function %}
    <button type="button" class="btn btn-primary btn-sm" id="return_onekey">一键归还</button>
    <button type="button" class="btn btn-primary btn-sm"  id="return_repair">报修归还</button>
    <button type="button" class="btn btn-primary btn-sm"  id="return_equipment">送还科室</button>
{% endblock %}

{% block script %}
{{ super() }}
<script type="text/javascript">
    $("#return_onekey").click(function(){
        action = 'return_onekey';
        $("#modal_return").modal("show");
    });
    $("#return_repair").click(function(){
        action = 'return_repair';
        $("#modal_return").modal("show");
    });
    $("#return_equipment").click(function(){
        action = 'return_equipment';
        $("#modal_return").modal("show");
    });
    //新增，编辑根据post的url来区别
    $("#modal_save").click(function(e) {
        if ($("#dept_code").val() && $("#type_code").val() && $("#equipment_code").val() && $("#fault_code").val() && $("#com_code").val()
                && $("#repair_man").val() && $("#repair_confirm_date").val()){
            e.preventDefault();
            //alert($("form").serialize());
            if (action == 'confirm'){
                url = '/repair/api/v1.0/equipment_repairs_confirm/confirm/' + cur_key;
            } else if (action == 'un_confirm'){
                url = '/repair/api/v1.0/equipment_repairs_confirm/un_confirm/' + cur_key;
            }else{url = ''};
            ajax_post_data(url, get_json_data());
            //if ( flag == 1){
                $("#modal_confirmed").modal("hide");     //隐藏模态框
                $("#table_repairs").bootstrapTable("refresh");  //刷新表格数据
				//$("#modal_confirmed")[0].reset();  //重置表单，恢复为默认值 如何解决表单重置reset is not a function 出错 问题就在于id="reset"和name="reset"，这里的reset属性覆盖了原来的reset方法

            //};
        }
    });
</script>
{% endblock %}


   <!--     <a href="{{ url_for('repair_return') }}">一键归还</a>   <!-- 考虑短期内同一故障再出现，返修 -->
<!--        <a href="{{ url_for('equipment_return') }}">报修归还</a>    <!-- 本科人员或维修方归还科室 -->
<!--        <a href="{{ url_for('equipment_return') }}">送还科室</a>   <!-- 考虑短期内同一故障再出现，返修 -->