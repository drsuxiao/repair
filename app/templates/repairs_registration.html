{% extends 'base_repairs.html' %}
{% block title %}报修登记管理{% endblock %}
{% block function %}
    <button type="button" class="btn btn-primary btn-sm" id="registration_add">报修登记</button>
    <button type="button" class="btn btn-primary btn-sm" id="registration_edit">报修编辑</button>
    <button type="button" class="btn btn-primary btn-sm" id="registration_delete">报修删除</button>
{% endblock %}
{% block modal %}
<!-- 模态框（Modal） -->
<form method="post" action="{{url_for('repairs_registration')}}" class="form-horizontal" role="form" id="myForm">
    <div class="modal fade" id="modal_registration" tabindex="-1" role="dialog" aria-labelledby="modal_registration_label" aria-hidden="true"
                data-backdrop="false" data-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="modal_registration_label">报修登记窗</h4>
            </div>
            <div class="modal-body">
                <form role="form" class="form-horizontal">
                    {{ form.hidden_tag() }}
                    {% for field in form if field.widget.input_type !='hidden' %}
                    <div class="form-group">
                        <label class="col-md-3 control-label">{{ field.label }}</label>
                        <div class="col-md-6">{{ field|safe }}</div>
                        <div class="col-md-3">
                            {% if field.errors %}
                                <ul class=errors>
                                {% for error in field.errors %}
                                  <li>{{ error }}</li>
                                {% endfor %}
                                </ul>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                <button type="submit" class="btn btn-primary" id="registration_save">保存</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>
</form>
<div class="modal fade" id="modal_delete" tabindex="-1" role="dialog" aria-labelledby="modal_delete_label" aria-hidden="true"
data-backdrop="false" data-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="modal_delete_label">删除数据确认提示窗</h4>
            </div>
            <div class="modal-body">
                <p>确认要删除所勾选数据吗？</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary">确定</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>

{% endblock %}

{% block script %}
{{ super() }}
<!-- 按钮事件 -->
<script>
    $("#registration_add").click(function(){
        $("#modal_registration").modal("show");
    });
    $("#registration_edit").click(function(){
        $("#modal_registration").modal("show");
    });
    $("#registration_delete").click(function(){
        $("#modal_delete").modal("show");
    });

    $("#registration_save").click(function(){

    });
</script>
<!-- 日期控件 -->
<script>
     $("#repair_date").datetimepicker({
            format: 'yyyy-mm-dd hh:ii',
            weekStart: 0,
            //startDate:new Date(),
            autoclose: true,
            startView: 2,  	//打开时显示的视图。0-'hour' 1-'day' 2-'month' 3-'year' 4-'decade'
            todayBtn : true,
            todayHighlight: true,
            bootcssVer:3,	//显示向左向右的箭头
            forceParse: true,  	//当输入非格式化日期时，强制格式化。默认true
            initialDate: new Date(),	//初始化日期.默认new Date()当前日期
            showMeridian: true, //是否显示上下午
            keyboardNavigation: true, //方向键改变日期
            language: 'zh-CN' //语言
     });

</script>
<!-- 模态框相关事件 -->
<script>
    function InitModalAddForm(){
        var list = ['repair_date','repair_registrant','dept_code','brand_code','type_code','equipment_code','fault_code','com_code'];
        $.each(list, function(i, val){
            //清除文本框的值,包含隐藏input
            item = $("#"+val);
            if (item.is("input")){
                item.val("");
            }
            else{
                //清除选择框的值
                item.selectpicker("val","");
            }
        })
    };
    $("#modal_registration").on('shown.bs.modal', function () {
        //初始化新增界面
        InitModalAddForm();
    });
    $("#modal_registration").on('hided.bs.modal', function () {
        //清空新增界面
        InitModalAddForm();
    })
</script>
{% endblock %}



        <!--<a href="{{ url_for('create_repair') }}">报修登记</a>
        <!--<a href="{{ url_for('create_repair') }}">报修编辑</a>   <!-- 是否限制本人操作 -->
       <!-- <a href="{{ url_for('create_repair') }}">报修删除</a>   <!-- 是否限制本人操作 -->
        |
       <!--  <a href="{{ url_for('create_repair') }}">报修确认</a>   <!-- 由维修方或专人确认报修，确认后不可修改 -->
       <!--  <a href="{{ url_for('create_repair') }}">报修取消</a>   <!-- 由维修方或专人取消确认报修，即可再次修改 -->
      <!--   <a href="{{ url_for('repair_return') }}">报修归还</a>   <!-- 本科人员确认修好后操作 -->
     <!--    <a href="{{ url_for('repair_return') }}">取消报修归还</a>   <!-- 考虑短期内同一故障再出现，返修 -->
      <!--   <a href="{{ url_for('equipment_return') }}">设备归还</a>    <!-- 本科人员或维修方归还科室 -->
      <!--   <a href="{{ url_for('equipment_return') }}">取消设备归还</a>   <!-- 考虑短期内同一故障再出现，返修 -->